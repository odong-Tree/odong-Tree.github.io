---
layout: post
title: 연산 프로퍼티 (Computed Properties)
category: Swift
tags: [Properties, Computed]
comments: true
---
>이 글은 공부 중에 작성하는 글입니다.
>정정이 필요한 내용은 댓글로 알려주시면 감사하겠습니다 :)

<br>

안녕하세요 오동나무입니다.  <br>

연산 프로퍼티가 갑자기 헷갈려서 정리할겸 연산 프로퍼티에 대해서 포스팅합니다. <br>

연산 프로퍼티는 C# 언어에서 빌려온 개념이라고 합니다. get과 set 구문을 사용하는 것이 특징입니다. 연산 프로퍼티가 무엇인지, get과 set은 어떤 기능을 하는지에 대해서 알아보겠습니다.

<br>
<br>

# 프로퍼티
본격적으로 연산 프로퍼티에 대해 살펴보기 전에, 프로퍼티에 대해서 간단하게 이야기하면,

```swift
struct Property {
    var name: String
    var number: Int
}
```

우리는 이렇게 생긴 변수나 상수를 프로퍼티라고 하는 것을 알고 있습니다. 하지만 프로퍼티에도 몇가지 종류가 있는데요, 이렇게 기본형태로 생긴 프로퍼티를 **저장 프로퍼티**라고 합니다. 프로퍼티의 종류에는 저장 프로퍼티, 연산 프로퍼티, 타입 프로퍼티, 지연 저장 프로퍼티 등이 있습니다. <br>

그리고 프로퍼티는 읽기만 가능하냐, 읽기쓰기 모두 가능하냐에 따라서도 분류해볼 수 있습니다. 간단하게, 저장 프로퍼티에서 let(상수)는 읽기전용, var(변수)는 읽기쓰기 프로퍼티로 볼 수 있습니다. 또한 연산 프로퍼티에서는 get만 제공할 경우 읽기전용, get과  set을 모두 제공할 경우 읽기쓰기 프로퍼티가 됩니다. <br>

>간단하게 저장 프로퍼티와 연산 프로퍼티를 살펴봅시다.<br>
**저장 프로퍼티**
-입력된 값을 저장하거나 저장된 값을 제공하는 역할
-상수 및 변수를 사용해서 정의 가능
-클래스와 구조체에서는 사용이 가능하지만, 열거형에서는 사용할 수 없음. <br>
>**연산 프로퍼티**
-연산을 통해 값을 만들어 제공하는 역할 -> 의존적인 값
-변수로만 선언 가능
-클래스, 구조체, 열거형, 모두에서 사용 가능

<br>

# 연산 프로퍼티 (Computed Properties)
연산 프로퍼티는 말 그대로 **연산**을 하는 프로퍼티입니다. 조금 더 풀어서 이야기하자면, 관계에서 얻어지는 값, 의존적인 값을 가지는 프로퍼티입니다.

```swift
class/struct/enum 객체명 {
    ...
    var 프로퍼티명 : 타입 {
        get {
            필요한 연산 코드
            return 반환값
        }
        set(매개변수명) {
            필요한 연산 코드
        }
    }
}
```

연산프로퍼티는 이렇게 생겼습니다. **get** 과 **set** 구문이 눈에 띕니다. 연산프로퍼티는 이렇게 get과 set을 제공하는 프로퍼티입니다. 연산 프로퍼티는 다시 2가지로 나뉘게 됩니다. <br>

```swift
struct Odongnamu {
    var weight: Int

    // 읽기전용
    var age: Int {
        get {
            return 500
        }
    }

    // 읽기쓰기 가능
    var height: Int {
        get {
            return weight * 2
        }
        set {
            weight = newValue / 2
        }
    }
}
```

**get과 set이** 모두 제공되면 읽기쓰기가 가능한 프로퍼티, **get만** 제공되면 읽기전용 프로퍼티가 됩니다. 만약 읽기전용 프로퍼티의 경우, get이라는 키워드를 생략해서 작성해줄 수 있습니다. **하지만! 쓰기전용, set만 제공하는 연산 프로퍼티는  존재하지 않습니다!**

```swift
struct Odongnamu {    
    // 읽기전용
    var age: Int {
        return 500
    }
}
```


<br>

### ✐ 선언
**연산 프로퍼티는 무조건 변수(var)로만 선언할 수 있습니다.** 위에서 연산 프로퍼티는 의존적인 값을 가지는 프로퍼티라고 언급했는데요, 다른 프로퍼티나 메서드에 따라 값이 결정되기 때문에 당연하게 변수로만 선언이 가능합니다. <br>

또한 연산 속에서 자기 자신의 값을 다루지 않습니다. 무슨 말이냐면,

```swift
struct Odongnamu {
    var weight: Int {
        get  {
            return weight
        }
        set {
            weight = newValue * 10
        }
    }
}
```

이렇게 weight가 자기 자신을 연산하게 되면 안됩니다. 코드에서 에러가 발생하는 것은 아닙니다. 하지만 플레이그라운드에서 한참을  running하다가 맥북이 뜨거워지더군요. <br>

만약  weight를 연산하는  연산 프로퍼티를  만들고 싶다면 새로운  프로퍼티를  만들어 weight를 연산하게 만들어주어야 합니다. 연산 프로퍼티가 자기 자신을 연산하게 되면 연산이  끝나지 않고 계속해서 호출이 일어나기 때문에 연산이 끝나지 않는 상황이 발생합니다.

<br>

### ✐ get, set, 의존적인 값
본격적으로 연산 프로퍼티의 핵심인 get과 set을 이해해봅시다. 앞서 연산 프로퍼티는 **의존적인 값**을 가지는 프로퍼티라고 했습니다. **나이**를 예로 들어보겠습니다. 나이는 현재 연도와 태어난 연도에 의존하는 값입니다.

```swift
현재 나이 = 현재 연도 - 태어난 연도 + 1
```

태어난 연도는 고정값을 가지겠지만 현재 연도와 나이는 유동적인 값을 가지겠지요? 그리고 하나의 값을 알면 다른 값을 알 수 있는 의존적인 관계입니다. 이를 코드로 옮겨보면,

```swift
struct AgeCalculator {
    let birthYear = 1700
    var currentYear: Int
    var odongAge: Int {
        get {
            return currentYear - 1700 + 1
        }
        set {
            currentYear = newValue + 1700 - 1
        }
    }
}

var calculator = AgeCalculator(currentYear: 2021)
print(calculator.odongAge)  // 322
```

이런 코드가 만들어집니다. 현재  연도를 알면 자동으로 나이를 알 수 있는 것입니다. 그렇다면 get은 이해가 되었는데, set은 어떻게 이해할 수 있을까요? <br>

위에서 설명했듯이 읽기전용으로 쓰고싶다면 set은 생략이 가능합니다. 하지만 위의 나이 예시의 경우에, 제 나이가 만약 500살이라면 현재 연도 역시 다른 값을 가져야합니다. odong의 나이가 500살이라면 그때의 현재 연도는 2199년이 되어야겠네요. <br>

**연산 프로퍼티는 의존적인 값이라고 했습니다!** 연산 프로퍼티의 값을 재설정해준다면 연산에 사용되었던 값도 같이 변경되어야 의존적인 관계가 유지됩니다. 만약 한쪽의 값만 변한다면 이를 의존적인 값이라고 할 수 없겠지요? 그렇기 때문에 연산 프로퍼티의 값을 변경해주기 위해서는 **set**이 필요한 것입니다.

```swift
calculator.odongAge = 500
print(calculator.currentYear) // 2199
```

<br>

### ✐ newValue
위의 코드에서 newValue라는 값이 있습니다. 우리는 저런 값을 선언해준 적이 없지만 swift에서 자동으로 제공하는 값입니다. 말 그대로 연산프로퍼티에 새로 할당해준 값을 newValue라고 합니다. 만약 newValue가 아닌 직접 이름을 만들어서 사용하고 싶다면

```swift
set(age) {
    currentYear = age + 1700 - 1
}
```

이렇게 set 옆에 선언해주는 것으로 사용할 수 있습니다.

<br>

----------
<br>

추가적으로 지연 저장 프로퍼티에 대해서 궁금하다면 [lazy var (지연 저장 프로퍼티)](https://odong-tree.github.io/swift/2021/01/16/lazyvar/) 포스팅을 추천합니다 :)



<br>
<br>

#### 참고
- [https://docs.swift.org/swift-book/LanguageGuide/Properties.html](https://docs.swift.org/swift-book/LanguageGuide/Properties.html)
